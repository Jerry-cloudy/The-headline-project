"use strict";(self["webpackChunktoutiao_m"]=self["webpackChunktoutiao_m"]||[]).push([[488],{2488:function(t,e,s){s.r(e),s.d(e,{default:function(){return c}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-container"},[e("van-nav-bar",{staticClass:"page-nav",attrs:{title:"登录"},scopedSlots:t._u([{key:"left",fn:function(){return[e("van-icon",{attrs:{name:"cross"},on:{click:function(e){return t.$router.back()}}})]},proxy:!0}])}),e("van-form",{ref:"loginForm",on:{submit:t.onSubmit}},[e("van-field",{attrs:{name:"mobile",label:"手机号",placeholder:"手机号",clearable:"",rules:t.userFormRules.mobile},model:{value:t.user.phoneNumber,callback:function(e){t.$set(t.user,"phoneNumber",e)},expression:"user.phoneNumber"}},[e("i",{staticClass:"toutiao toutiao-shouji",attrs:{slot:"left-icon"},slot:"left-icon"})]),e("van-field",{attrs:{type:"password",name:"code",label:"验证码",placeholder:"验证码",rules:t.userFormRules.code},scopedSlots:t._u([{key:"left-icon",fn:function(){return[e("i",{staticClass:"toutiao toutiao-yanzhengma"})]},proxy:!0},{key:"button",fn:function(){return[t.isCountDownShow?e("van-count-down",{attrs:{time:3e4,format:"ss 秒"},on:{finish:function(e){t.isCountDownShow=!1}}}):e("van-button",{staticClass:"send-sms-btn",attrs:{"native-type":"button",round:"",size:"small",type:"default"},on:{click:function(e){return t.onSendSms()}}},[t._v("发送验证")])]},proxy:!0}]),model:{value:t.user.code,callback:function(e){t.$set(t.user,"code",e)},expression:"user.code"}}),e("div",{staticClass:"login-btn-wrap"},[e("van-button",{staticClass:"login-btn",attrs:{block:"",type:"info","native-type":"submit"}},[t._v("登录")])],1)],1)],1)},n=[],a=s(4599),i={name:"Login-",data(){return{user:{phoneNumber:"",code:""},isCountDownShow:!1,userFormRules:{mobile:[{required:!0,message:"手机号不能为空"},{pattern:/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/,message:"手机号格式错误"}],code:[{required:!0,message:"验证码不能为空"},{pattern:/^\d{6}$/,message:"验证码格式错误"}]}}},methods:{async onSendSms(){try{await this.$refs.loginForm.validate("mobile"),console.log("验证成功")}catch(t){return console.log("验证失败",t)}this.isCountDownShow=!0;try{await(0,a.p1)(this.user.phoneNumber),this.$toast("发送成功")}catch(t){this.isCountDownShow=!1,429===t.response.status?this.$toast("发送太频繁了，请稍后重试"):this.$toast("发送失败，请稍后重试")}},async onSubmit(){this.$toast.loading({duration:0,forbidClick:!0,message:"登录中..."});try{const t=await(0,a.UO)({mobile:this.user.phoneNumber,code:this.user.code});this.$store.commit("setUser",t.data.data),this.$router.back(),this.$toast.success("登录成功")}catch(t){400===t.response.status?this.$toast.fail("手机号码或验证码输入错误！"):this.$toast.fail("系统错误，请稍后再试")}}}},r=i,u=s(1001),l=(0,u.Z)(r,o,n,!1,null,"e93e27c0",null),c=l.exports}}]);
//# sourceMappingURL=488.32c09402.js.map