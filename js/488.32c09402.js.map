{"version":3,"file":"js/488.32c09402.js","mappings":"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","sources":["webpack://toutiao-m/./src/views/login/login.vue","webpack://toutiao-m/src/views/login/login.vue","webpack://toutiao-m/./src/views/login/login.vue?772f","webpack://toutiao-m/./src/views/login/login.vue?d78d"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"login-container\"},[_c('van-nav-bar',{staticClass:\"page-nav\",attrs:{\"title\":\"登录\"},scopedSlots:_vm._u([{key:\"left\",fn:function(){return [_c('van-icon',{attrs:{\"name\":\"cross\"},on:{\"click\":function($event){return _vm.$router.back()}}})]},proxy:true}])}),_c('van-form',{ref:\"loginForm\",on:{\"submit\":_vm.onSubmit}},[_c('van-field',{attrs:{\"name\":\"mobile\",\"label\":\"手机号\",\"placeholder\":\"手机号\",\"clearable\":\"\",\"rules\":_vm.userFormRules.mobile},model:{value:(_vm.user.phoneNumber),callback:function ($$v) {_vm.$set(_vm.user, \"phoneNumber\", $$v)},expression:\"user.phoneNumber\"}},[_c('i',{staticClass:\"toutiao toutiao-shouji\",attrs:{\"slot\":\"left-icon\"},slot:\"left-icon\"})]),_c('van-field',{attrs:{\"type\":\"password\",\"name\":\"code\",\"label\":\"验证码\",\"placeholder\":\"验证码\",\"rules\":_vm.userFormRules.code},scopedSlots:_vm._u([{key:\"left-icon\",fn:function(){return [_c('i',{staticClass:\"toutiao toutiao-yanzhengma\"})]},proxy:true},{key:\"button\",fn:function(){return [(_vm.isCountDownShow)?_c('van-count-down',{attrs:{\"time\":1000 * 30,\"format\":\"ss 秒\"},on:{\"finish\":function($event){_vm.isCountDownShow = false}}}):_c('van-button',{staticClass:\"send-sms-btn\",attrs:{\"native-type\":\"button\",\"round\":\"\",\"size\":\"small\",\"type\":\"default\"},on:{\"click\":function($event){return _vm.onSendSms()}}},[_vm._v(\"发送验证\")])]},proxy:true}]),model:{value:(_vm.user.code),callback:function ($$v) {_vm.$set(_vm.user, \"code\", $$v)},expression:\"user.code\"}}),_c('div',{staticClass:\"login-btn-wrap\"},[_c('van-button',{staticClass:\"login-btn\",attrs:{\"block\":\"\",\"type\":\"info\",\"native-type\":\"submit\"}},[_vm._v(\"登录\")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<!-- 虽然style标签中设置了scoped属性 能够只影响当前的组件，但是每个组件 建议养成 给他们的跟标签设置一个专属的class 类名的习惯 -->\n  <div class=\"login-container\">\n    <!-- 导航栏 -->\n    <van-nav-bar class=\"page-nav\" title=\"登录\">\n      <template #left>\n      <!-- 为了模拟手机/pc的返回路由操作 $router.back() -->\n        <van-icon name=\"cross\" @click=\"$router.back()\" />\n      </template>\n    </van-nav-bar>\n    <van-form @submit=\"onSubmit\" ref=\"loginForm\">\n        <van-field\n            v-model=\"user.phoneNumber\"\n            name=\"mobile\"\n            label=\"手机号\"\n            placeholder=\"手机号\"\n            clearable\n            :rules=\"userFormRules.mobile\"\n        >\n            <!-- slot老式写法：虽然没废弃，但是不推荐使用 -->\n            <i slot=\"left-icon\" class=\"toutiao toutiao-shouji\"></i>\n        </van-field>\n        <van-field\n            v-model=\"user.code\"\n            type=\"password\"\n            name=\"code\"\n            label=\"验证码\"\n            placeholder=\"验证码\"\n            :rules=\"userFormRules.code\"\n        >\n            <!-- slot新版写法 -->\n            <template #left-icon>\n            <i class=\"toutiao toutiao-yanzhengma\"></i>\n            </template>\n            <!-- 发送验证码 按钮 -->\n            <template #button>\n            <!-- time: 倒计时时间 -->\n            <van-count-down\n                v-if=\"isCountDownShow\"\n                :time=\"1000 * 30\"\n                format=\"ss 秒\"\n                @finish=\"isCountDownShow = false\"\n            />\n            <!-- native-type=\"button\" 属性 防止触发表单提交事件 -->\n            <van-button\n            v-else\n            class=\"send-sms-btn\"\n            native-type=\"button\"\n            round\n            size=\"small\"\n            type=\"default\"\n            @click=\"onSendSms()\"\n            >发送验证</van-button>\n            </template>\n        </van-field>\n        <!-- 修改登录按钮的样式 -->\n        <div class=\"login-btn-wrap\">\n            <van-button class=\"login-btn\" block type=\"info\" native-type=\"submit\">登录</van-button>\n        </div>\n    </van-form>\n  </div>\n</template>\n\n<script>\n// 首先进入到页面后 就应该先跳转到 登陆页 先进行登录操作，所以需要将根页面定向到login页面\n\n// 目标：\n// 注册点击登录的事件\n// 获取表单数据（根据接口要求使用 v-model 绑定）\n// 表单验证\n// 发请求提交\n// 根据请求结果做下一步处理\nimport { loginAPI, getSmsCodeAPI } from '@/api'\nexport default {\n  name: 'Login-',\n  data () {\n    return {\n      user: {\n        phoneNumber: '',\n        code: ''\n      },\n      isCountDownShow: false,\n      userFormRules: {\n        /**\n         * 手机号码验证规则数组\n         * 1.必填项-required\n         * 2.手机号的基本规则 11位的数组，前边是1[3479]后边的九位是任意数字- 使用正则验证（pattern）\n         */\n        mobile: [{\n          required: true,\n          message: '手机号不能为空'\n        }, {\n          pattern: /^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\\d{8}$/,\n          message: '手机号格式错误'\n        }],\n        /**\n         * 验证码验证规则数组\n         * 1.必填项-required\n         * 2.验证码的基本规则 - 六位的数字 使用正则验证（pattern）\n         */\n        code: [{\n          required: true,\n          message: '验证码不能为空'\n        }, {\n          pattern: /^\\d{6}$/,\n          message: '验证码格式错误'\n        }]\n      }\n    }\n  },\n  methods: {\n    // 获取验证码\n    async onSendSms () {\n      // 1. 校验手机号\n      try {\n        // console.log(this.$refs.loginForm)\n        // 只要看到Promise对象 就要想到 async 和 await 来接收数据\n        // validate（表单控件的name属性）\n        await this.$refs.loginForm.validate('mobile')\n        console.log('验证成功')\n      } catch (err) {\n        return console.log('验证失败', err)\n      }\n      // 2. 验证通过，显示倒计时\n      this.isCountDownShow = true\n      // 3. 请求发送验证码\n      try {\n        await getSmsCodeAPI(this.user.phoneNumber)\n        this.$toast('发送成功')\n      } catch (err) {\n        // 发送失败，关闭倒计时\n        this.isCountDownShow = false\n        if (err.response.status === 429) {\n          this.$toast('发送太频繁了，请稍后重试')\n        } else {\n          this.$toast('发送失败，请稍后重试')\n        }\n      }\n    },\n    // 提交按钮\n    async onSubmit () {\n      //  console.log('submit', this.user)\n      this.$toast.loading({\n        duration: 0, // 持续时间，0表示持续展示不停止\n        forbidClick: true, // 是否禁止背景点击\n        message: '登录中...' // 提示消息\n      })\n      try {\n        // 采用对象赋值的完整写法，其目的是以后回过头来看代码时，可以更快速的定位到需求\n        const res = await loginAPI({\n          mobile: this.user.phoneNumber,\n          code: this.user.code\n        })\n        // console.log('登录成功', res)\n        // console.log(this.$store)\n\n        // 调用store中的方法，将接口返回的token存到状态管理器中\n        this.$store.commit('setUser', res.data.data)\n        // 通过$router.back()进行页面路由的退回\n        this.$router.back()\n        // 提示 success 或者 fail 的时候，会先把其它的 toast 先清除\n        this.$toast.success('登录成功')\n      } catch (err) {\n        // 通过观察 err 返回的结果发现 错误信息源自于 err.response\n        // console.log(err, '错误代码')\n        if (err.response.status === 400) {\n          // console.log('手机号码或验证码输入错误！', err)\n          this.$toast.fail('手机号码或验证码输入错误！')\n        } else {\n          // console.log('系统错误，请稍后再试', err)\n          this.$toast.fail('系统错误，请稍后再试')\n        }\n      }\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n.login-container {\n    // 修改字体图标的大小\n    .toutiao{\n        font-size: 32px;\n    }\n    // 设置发送验证码框的样式\n    .send-sms-btn {\n        background-color: #ededed;\n    }\n    .send-sms-btn {\n        width: 152px;\n        line-height: 46px;\n        background-color: #ededed;\n        font-size: 22px;\n        color: #666;\n    }\n    // 设置登录按钮的样式\n    .login-btn-wrap {\n        padding: 53px 33px;\n        .login-btn {\n        background-color: #6db4fb;\n        border: none;\n        }\n    }\n    // 设置登录 退回上一页的按钮的样式\n    .page-nav {\n      .van-icon{\n        color: #fff;\n      }\n    }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./login.vue?vue&type=template&id=e93e27c0&scoped=true&\"\nimport script from \"./login.vue?vue&type=script&lang=js&\"\nexport * from \"./login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./login.vue?vue&type=style&index=0&id=e93e27c0&prod&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e93e27c0\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","scopedSlots","_u","key","fn","on","$event","$router","back","proxy","ref","onSubmit","userFormRules","mobile","model","value","user","phoneNumber","callback","$$v","$set","expression","slot","code","isCountDownShow","onSendSms","_v","staticRenderFns","name","data","required","message","pattern","methods","console","duration","forbidClick","component"],"sourceRoot":""}